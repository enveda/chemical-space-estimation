# Defining the limits of plant chemical space: challenges and estimations

This repository contains code and data described in detail in our paper (Engler Hart *et al.*, 2025).

## Table of Contents

* [Citation](#citation)
* [Reproducibility](#reproducibility)
* [Data](#data)
* [How to run](#how-to-run)

### Citation
If you have found our manuscript useful in your work, please consider citing:

> [Engler Hart, C, et al. (2025). Defining the limits of plant chemical space: challenges and estimations. *GigaScience*, giaf033](https://doi.org/10.1093/gigascience/giaf033).

## Reproducibility
To reproduce the results, the Python virtual environment can be installed using [Poetry](https://python-poetry.org/).

## Data
Datasets are publically available and can be directly downloaded from Zenodo. The files should be unzipped and placed in the `data` directory.

See here: [![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.14618408.svg)](https://doi.org/10.5281/zenodo.14618408)

Furthermore, the directory `figures` contains all the figures of the manuscript (generated by the notebooks) as well as the raw and intermediary files (also generated by the notebooks).

## How to run

Run the notebooks located in the `notebooks` corresponding to each analysis. The prefix of the notebooks indicates the order in which it is run. The notebooks reproduce the figures in the manuscript and supplementary.

1. Clone the repository to get its contents locally:
```bash
git clone https://github.com/enveda/chemical-space-estimation.git
cd chemical-space-estimation
```

2. Prepare the data directory as mentioned in the [Data section](#data).

3. Initiate the poetry environment with python using the following commands:
```bash
poetry install
poetry init
```
> **_NOTE:_** Please ensure you have Python version 3.10 installed on your system to run the codes efficiently. If not, please install from [here](https://www.python.org/downloads/) according to you OS.

For running the Jupyter notebooks, the virtual environment installed above can be selected.

For running python files, use the following command in the terminal:
```bash
poetry run python REPLACE_WITH_FILE_NAME.py
```

4. Once all dependencies are installed, you can run the notebooks for the following analysis:
* [Data Statistics](notebooks/1_data_stats.ipynb) - Data collection and summary on ENPKG.
* [Chemical class distribution](notebooks/2_chemical_class_distribution.ipynb) - Chemical class distribution of in the ENPKG dataset.
* [Entropy score](notebooks/4_get_spectral_entropy_scores.py) - Calculating the Spectral Entropy Scores for the dataset. 
* [Entropy score matrix](notebooks/5_create_entropy_sim_matrix.py) - Generating the Entropy Score matrix
* [Spectral clustering](notebooks/6_ms2_clustering.ipynb) - Generating MS2 spectra clusters in the dataset
* [Comparing the known space](notebooks/7_literature_known_space.ipynb) - Comparison of the known chemical space between literature curated databases and the ENPKG dataset.
* [Estimating chemical space](notebooks/8_estimating_chemical_space_m+h.ipynb) - Approximate calculations for the chemical space required for understanding the plant landscape
* [Diversity assessment](10_plant_diversity.ipynb) - Assessing the diversity of ENPKG datasets with the plant kingdom.
